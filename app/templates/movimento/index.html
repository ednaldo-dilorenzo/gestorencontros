<div class="d-flex justify-content-between">
  <h2 class="fs-4">Movimentos Cadastrados</h2>
  <nav style="--bs-breadcrumb-divider: '>'" aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page">
        Movimentos
      </li>
    </ol>
  </nav>
</div>
<hr />
<nav class="navbar bg-body-tertiary">
  <div class="container-fluid">
    <a
      href="/pages{{ url_for('movimento.register') }}"
      class="btn btn-primary"
      data-link
      >+ Novo</a
    >
  </div>
</nav>
{% if movimentos %}
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Nome</th>
      <th scope="col">Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for movimento in movimentos %}
    <tr>
      <th scope="row">{{ movimento.id }}</th>
      <td class="editable-cell">{{ movimento.nome }}</td>
      <td>
        <a
          class="btn btn-sm icon-link icon-link-hover"
          href="/pages{{ url_for('movimento.edit', id=movimento.id) }}"
          data-link
        >
          <i class="fas fa-pen"></i>
        </a>
        <a
          class="btn btn-sm icon-link icon-link-hover"
          href="/pages{{ url_for('movimento.equipe.index', id_movimento=movimento.id) }}"
          data-link
        >
          <i class="fas fa-people-group"></i>
        </a>
        <a
          class="btn btn-sm icon-link icon-link-hover"
          href="/pages{{ url_for('movimento.encontro.index', id_movimento=movimento.id) }}"
          data-link
        >
          <i class="fa-solid fa-person-praying"></i>
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
  <div class="data-not-found py-3">
    <h1>Nenhum dado encontrado...</h1>
  </div>
{% endif %}
<script>
  $.fn.makeEditable = function() {
    $(this).on('click',function(){
      if($(this).find('input').is(':focus')) return this;
      var cell = $(this);
      var content = $(this).html();
      $(this).html('<input class="form-control" type="text" value="' + $(this).html() + '" />')
        .find('input')
        .trigger('focus')
        .on({
          'blur': function(){
            $(this).trigger('closeEditable');
          },
          'keyup':function(e){
            if(e.which == '13'){ // enter
              $(this).trigger('saveEditable');
            } else if(e.which == '27'){ // escape
              $(this).trigger('closeEditable');
            }
          },
          'closeEditable':function(){
            cell.html(content);
          },
          'saveEditable':function(){
            content = $(this).val();
            $(this).trigger('closeEditable');
          }
      });
    });
  return this;
  }

  $(".editable-cell").makeEditable();
</script>
